
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<title>Hello</title>

<!-- keywords -->


<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="Hello">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hello">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="XU LIN">
<meta name="twitter:card" content="summary">

<link rel="alternative" href="/atom.xml" title="Hello"
	type="application/atom+xml">
<link rel="icon" href="">
<link rel="stylesheet" href="/css/style.css">





<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>


<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>



<meta name="generator" content="Hexo 4.2.1">
</head>
<body>
	<div id="container">
		<div id="particles-js"></div>
		<div class="left-col">
			<div class="overlay"></div>
			<div class="intrude-less">
				<header id="header" class="inner">
					<a href="/" class="profilepic"> <img
						lazy-src="/img/微信图片_20200901134748.jpg" class="js-avatar">

					</a>

					<hgroup>
						<h1 class="header-author">
							<a href="/">XU LIN</a>
						</h1>
					</hgroup>




					<div class="switch-btn">
						<div class="icon">
							<div class="icon-ctn">
								<div class="icon-wrap icon-house" data-idx="0">
									<div class="birdhouse"></div>
									<div class="birdhouse_holes"></div>
								</div>
								<div class="icon-wrap icon-ribbon hide" data-idx="1">
									<div class="ribbon"></div>
								</div>

								<div class="icon-wrap icon-link hide" data-idx="2">
									<div class="loopback_l"></div>
									<div class="loopback_r"></div>
								</div>


							</div>

						</div>
						<div class="tips-box hide">
							<div class="tips-arrow"></div>
							<ul class="tips-inner">
								<li>菜单</li>
								<li>标签</li>
								<li>友情链接</li>
							</ul>
						</div>
					</div>


					<div class="switch-area">
						<div class="switch-wrap">
							<section class="switch-part switch-part1">
								<nav class="header-menu">
									<ul>

										<li><a href="/">主页</a></li>

										<li><a href="/archives">所有文章</a></li>

									</ul>
								</nav>
								<nav class="header-nav">
									<div class="social"></div>
								</nav>
							</section>


							<section class="switch-part switch-part2">
								<div class="widget tagcloud" id="js-tagcloud"></div>
							</section>



							<section class="switch-part switch-part3">
								<div id="js-friends">

									<a target="_blank" class="main-nav-link switch-friends-link"
										href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
								</div>
							</section>
						</div>
					</div>
				</header>
			</div>
		</div>
		<div class="mid-col">
			<nav id="mobile-nav">
				<div class="overlay">
					<div class="slider-trigger"></div>
					<h1 class="header-author js-mobile-header hide">XU LIN</h1>
				</div>
				<div class="intrude-less">
					<header id="header" class="inner">
						<div class="profilepic">
							<img lazy-src="/img/微信图片_20200901134748.jpg" class="js-avatar">
						</div>
						<hgroup>
							<h1 class="header-author">XU LIN</h1>
						</hgroup>

						<nav class="header-menu">
							<ul>

								<li><a href="/">主页</a></li>

								<li><a href="/archives">所有文章</a></li>

								<div class="clearfix"></div>
							</ul>
						</nav>
						<nav class="header-nav">
							<div class="social"></div>
						</nav>
					</header>
				</div>
			</nav>
			<div class="body-wrap">

				<article id="post-hello-world" class="article article-type-post"
					itemscope itemprop="blogPost">

					<div class="article-meta">
						<a href="/2020/06/19/hello-world/" class="article-date"> <time
								datetime="2020-06-19T02:24:54.719Z" itemprop="datePublished">2020-06-19</time>
						</a>
					</div>

					<div class="article-inner">

						<input type="hidden" class="isFancy" />


						<header class="article-header">


							<h1 itemprop="name">
								<a class="article-title" href="/2020/06/19/hello-world/">
									Hello World </a>
							</h1>


						</header>


						<div class="article-entry" itemprop="articleBody">

							<p>Welcome to XU LIN Blog .</p>
							<h1 id="Sql Server">
								<p>DevExpress</p>
							</h1>
							<h2 id="">
								<font size="5" color="Aqua" ><p>Dev 基本使用：</p></font>
							</h2>
							
							<figure class="highlight bash">		
						<pre>
<span class="line">
<font size="4">	
<font  color="DeepSkyBlue" >--//gridView赋值</font>
gridControl.DataSource = DataTable;
<font  color="DeepSkyBlue" >--//改变某一列的宽度（下标或者列明）</font>
gridView.Columns[下表或者列明].Width = 80;
<font  color="DeepSkyBlue" >--//列宽自适应内容</font>
gridView.BestFitColumns(); 
<font  color="DeepSkyBlue" >--//是否可以编辑</font>
gridView.OptionsBehavior.Editable = false;
<font  color="DeepSkyBlue" >--//清楚数据</font>
gridControl.DataBindings.Clear();
gridControl.DataSource = null;
gridView.Columns.Clear();
<font  color="DeepSkyBlue" >--//添加一列单选框</font>
gridView.OptionsSelection.CheckBoxSelectorColumnWidth = 30;
gridView.OptionsSelection.MultiSelect = true;
gridView.OptionsSelection.MultiSelectMode = DevExpress.XtraGrid.Views.Grid.GridMultiSelectMode.CheckBoxRowSelect;
gridView.OptionsSelection.ShowCheckBoxSelectorInColumnHeader = DevExpress.Utils.DefaultBoolean.True;
<font  color="DeepSkyBlue" >--//获得指定行的数据</font>
DataRow dr =  gridView1.GetDataRow(int);第几行   DataRow
<font  color="DeepSkyBlue" >--//获得选中的行号</font>
int  FocusedRowHandle = gridView1.FocusedRowHandle;  
<font  color="DeepSkyBlue" >--//显示滚动条</font>
 this.gridView1.OptionsView.ColumnAutoWidth = false;
<font  color="DeepSkyBlue" >--//列表宽度自适应内容</font>
gridView1.OptionsView.ColumnAutoWidth = false;
for (int I = 0; I < gridView1.Columns.Count; I++)
{
    this.gridView1.BestFitColumns();
    this.gridView1.Columns[I].BestFit();//自动列宽
}
<font  color="DeepSkyBlue" >--//拖拽时某一列不动</font>
gridView1.Columns[0].Fixed = DevExpress.XtraGrid.Columns.FixedStyle.Left;
<font  color="DeepSkyBlue" >--//隐藏 GridControl 的 GroupPanel 表头</font>
this.gridView1.OptionsView.ShowGroupPanel = false;
<font  color="DeepSkyBlue" >--//表格框的线条去除</font>
gridView1.Appearance.HorzLine.BackColor = Color.White;
gridView1.Appearance.VertLine.BackColor = Color.White;
<font  color="DeepSkyBlue" >--//隔行换色</font>
this.gridView1.Appearance.OddRow.BackColor = Color.White;  // 设置奇数行颜色 // 默认也是白色 可以省略 
this.gridView1.OptionsView.EnableAppearanceOddRow = true;   // 使能 // 和和上面绑定 同时使用有效 
this.gridView1.Appearance.EvenRow.BackColor = Color.WhiteSmoke; // 设置偶数行颜色 
this.gridView1.OptionsView.EnableAppearanceEvenRow = true;   // 使能 // 和和上面绑定 同时使用有效
<font  color="DeepSkyBlue" >--//不可编辑</font>
 gridView1.OptionsBehavior.Editable = false;
<font  color="DeepSkyBlue" >--//选中每个单元格</font>
this.gridView1.OptionsSelection.MultiSelect = true;
<font  color="DeepSkyBlue" >--//添加单选框</font>
gridView1.OptionsSelection.MultiSelectMode = DevExpress.XtraGrid.Views.Grid.GridMultiSelectMode.CheckBoxRowSelect;           
gridView1.OptionsSelection.CheckBoxSelectorColumnWidth = 30;
<font  color="DeepSkyBlue" >--//某一列变色</font>
 //BackColor 背景色
 //BackColor  BackColor2 设渐变背景
 //ForeColor 设计字体颜色
 gridView1.Columns["列名"].AppearanceCell.BackColor2 = Color.Blue;
 gridView1.Columns["列名"].AppearanceCell.BackColor = Color.LightGreen;
 gridView1.Columns["列名"].AppearanceCell.ForeColor = Color.White;
<font  color="DeepSkyBlue" >--//时间格式的设定</font>
devexpress gridcontrol里gridview中列日期格式的设置
默认d格式结果日期格式为：2018-3-1
这里可以改成g日期格式为：2018-3-1 09:07
这里我们也可以指定成：yyyy-MM-dd hh:mm:ss
结果为：2018-3-1 09:07:32
gridView1.Columns["字段3"].DisplayFormat.FormatString = "d";
gridView1.Columns["字段3"].DisplayFormat.FormatString = "g";
gridView1.Columns["字段3"].DisplayFormat.FormatString = "yyyy年MM月";
gridView1.Columns["字段3"].DisplayFormat.FormatType = FormatType.DateTime;
参考http://www.kai8wu.com/content/artsta/102.html  

<font  color="DeepSkyBlue" >--//某一列变色</font>
<font size="5" color="Aqua" >导出数据 （导出一个gridView)</font>
<input type='button' value='展开详细' name='btn1' onclick="if(bfq.style.display=='none'){bfq.style.display='';showbfq.innerText='内容';}else{bfq.style.display='none';showbfq.innerText='导出数据 （导出一个gridView)';}">
<table ><tr><td  height="80" align="center" name="bfq" id="bfq" style="display:none;">
	SaveFileDialog saveFile = new SaveFileDialog();
	saveFile.Title = "请选择文件存放路径";
	saveFile.Filter = "Excel文档(*.xls)|*.xls|Excel文档(*.xlsx)|*.xlsx";
	//saveFile.FileName =  DateTime.Now.ToString("yyyyMMddHhmmss");
	if (saveFile.ShowDialog() == DialogResult.OK)
	{
	    gridView1.OptionsPrint.AutoWidth = true;
	    gridView1.AppearancePrint.Row.Font = new System.Drawing.Font("宋体", 9);//设置格式
	    string extension = Path.GetExtension(saveFile.FileName);
	    //选择格式选择ExportToXls或者ExportToXlsx
	   if (extension.ToUpper() == ".XLS")
	   {	
	       DevExpress.XtraPrinting.XlsExportOptions options = new DevExpress.XtraPrinting.XlsExportOptions();
	       options.TextExportMode = DevExpress.XtraPrinting.TextExportMode.Text;
	       options.SheetName = "";//设置exec的sheet名称
	       gridView1.ExportToXls(saveFile.FileName, options);
	
	   }
	   else if (extension.ToUpper() == ".XLSX")
	   {
	       DevExpress.XtraPrinting.XlsxExportOptions options = new DevExpress.XtraPrinting.XlsxExportOptions();
	       options.TextExportMode = DevExpress.XtraPrinting.TextExportMode.Text;
	       options.SheetName = tDateTimePicker1.DateTime.Year + "-" + tDateTimePicker1.DateTime.Month;
	       gridView1.ExportToXlsx(saveFile.FileName, options);
	
	   }
	
	}
	else {
	    return;
	}
</td></tr></table>
<font  color="DeepSkyBlue" >导出多个gridView到一个exec</font>
https://www.cnblogs.com/todayhero/p/11120921.html
<table ><tr><font size="5" color="Aqua" >导出数据 （导出多个gridView或者多个Table）</font>
<input  type='button' value='展开详细' name='btn2' onclick="if(bf.style.display=='none'){bf.style.display='';showbf.innerText='内容';}else{bf.style.display='none';showbf.innerText='导出数据 （导出多个gridView或者多个Table）';}"></tr> <tr> <td height="80" align="center" name="bf" id="bf" style="display:none;">	
	   SaveFileDialog saveFile = new SaveFileDialog();
            saveFile.Title = "请选择文件存放路径";
            saveFile.Filter = "Excel文档(*.xls)|*.xls|Excel文档(*.xlsx)|*.xlsx";
            //saveFile.FileName = DateTime.Now.ToString("yyyyMMddHhmmss");
            if (saveFile.ShowDialog() == DialogResult.OK)
            {
                string extension = Path.GetExtension(saveFile.FileName);
                DevExpress.XtraPrintingLinks.CompositeLink link = new DevExpress.XtraPrintingLinks.CompositeLink(new DevExpress.XtraPrinting.PrintingSystem());
                                          
                if (extension.ToUpper() == ".XLS")
                {
                    DevExpress.XtraPrinting.XlsExportOptions op = new DevExpress.XtraPrinting.XlsExportOptions();
                    foreach (System.Data.DataTable dt in ds.Tables)
                    {

                        GridControl gridControl = new GridControl() { DataSource = dt };
                        this.Controls.Add(gridControl);

                        GridView grid = new GridView();                     
                        gridControl.MainView = grid;
                        grid.OptionsPrint.AutoWidth = false;//*导出时候列很不够宽
                        op.SheetName =;//命名sheeet
                        op.ExportMode = XlsExportMode.SingleFilePageByPage;
                        PrintableComponentLink plink = new PrintableComponentLink { Component = gridControl };
                        link.Links.Add(plink);

                    }

                    link.CreatePageForEachLink();
                    link.ExportToXls(saveFile.FileName, op);               
</td></tr></table>
<font  color="DeepSkyBlue" >--//使用DevExpress.XtraWaitForm.WaitForm实现加载框效果</font>
参考：https://blog.csdn.net/weixin_30502965/article/details/94841544
注意创建加载窗体需要拖控件ProgressPanel（DevExpress.XtraWaitForm.ProgressPanel）
<font  color="DeepPink" >--//使用根据值改变单元格的背景色</font>
可以参考https://blog.csdn.net/u012235352/article/details/100919576
问题当改变单元格颜色后导出exec并未带颜色
注： 在导出时使用
DevExpress.XtraPrinting.XlsExportOptionsEx options = new DevExpress.XtraPrinting.XlsExportOptionsEx();
options.ExportType = DevExpress.Export.ExportType.WYSIWYG;
根据单元格内容改变颜色还有其他方法在Run Designer设计 前提在Designer设计添加列并非 gridcontrol.datasource = table
private void gridView1_RowCellStyle(object sender, RowCellStyleEventArgs e)
{
   string value = e.CellValue.ToString();
   
    if (value.Contains("M"))
    {
        e.Appearance.BackColor = Color.DodgerBlue;
    }
    else if (value.Contains("Y"))
    {
        e.Appearance.BackColor = Color.SpringGreen;
    }                        
}
<font  color="DeepSkyBlue" >--//使用dev提示框</font>
导出成功后打开导出的exce
if (XtraMessageBox.Show("导出成功,是否打开", "提示", MessageBoxButtons.YesNo, MessageBoxIcon.Information) == DialogResult.Yes)
{
    System.Diagnostics.Process.Start(fileDialog.FileName);
}
<font  color="DeepSkyBlue" >--//导出exec 列头很窄添加</font>    
gridView1.OptionsPrint.AutoWidth = false;//*
<font size="5" color="Aqua" >导出数据 多个datatable（普通方法比较慢添加进度条功能）</font>
<input type='button' value='展开详细' name='bt' onclick="if(bfqtable.style.display=='none'){bfqtable.style.display='';showbfqtable.innerText='内容';}else{bfqtable.style.display='none';showbfqtable.innerText='导出数据 （导出一个gridView)';}">
<table ><tr><td  height="80" align="center" name="bfqtable" id="bfqtable" style="display:none;">
SaveFileDialog saveFileDialog = new SaveFileDialog();
saveFileDialog.DefaultExt = "xlsx";
saveFileDialog.Title = "Export data to Execl table";
saveFileDialog.Filter = "microsoft office execl files (*.xlsx)|*.xlsx";
saveFileDialog.RestoreDirectory = true;

if (saveFileDialog.ShowDialog() == DialogResult.OK)
{
  
    TProgressBar tProgressBar1 = new TProgressBar();
    dpnlRight.Controls.Add(tProgressBar1);
    tProgressBar1.BringToFront();
    tProgressBar1.Visible = true;
    tProgressBar1.Width = 150;
    tProgressBar1.Height = 30;
    tProgressBar1.Location = new System.Drawing.Point((Parent.Width - tProgressBar1.Width) / 2 - 90, (Parent.Height - tProgressBar1.Height) / 2 - 90);
    tProgressBar1.Properties.Maximum = 12;
    tProgressBar1.Properties.Minimum = 0;
    tProgressBar1.Position = 0;//当前值
    tProgressBar1.Properties.ShowTitle = true;//是否显示进度数据   
    tProgressBar1.Properties.PercentView = true; //是否显示百分比
    
    System.Reflection.Missing miss = System.Reflection.Missing.Value;
    Microsoft.Office.Interop.Excel.Application xlapp = new Microsoft.Office.Interop.Excel.Application();

    xlapp.Visible = false;
    Workbooks workbooks = xlapp.Workbooks;
    Workbook workbook = workbooks.Add(true);

    workbook.Sheets.Add(miss, workbook.Sheets[1], ds.Tables.Count - 1, miss);
    for (int d = 0; d < ds.Tables.Count; d++)
    {
        Worksheet ws = workbook.Worksheets[d + 1] as Worksheet;
        int month = d + 1;
        ws.Name = tDateTimePicker1.DateTime.ToString("yyyy") + "-" + month;//命名sheet

        int totalCellsCount = ds.Tables[d].Columns.Count;
        Range range = ws.Range[ws.Cells[1, 1], ws.Cells[1, ds.Tables[d].Columns.Count]];
        //生成列
        for (int i = 0; i < ds.Tables[d].Columns.Count; i++)
        {
            range.Cells[1, i + 1] = ds.Tables[d].Columns[i].ColumnName;
            range.Interior.ColorIndex = 15;
            range.Font.Bold = true;
            range.Font.Size = 10;
            range.EntireColumn.AutoFit();
            range.EntireRow.AutoFit();
        }

        //插入数据
        for (int r = 0; r < ds.Tables[d].Rows.Count; r++)
        {
            for (int i = 0; i < ds.Tables[d].Columns.Count; i++)
            {
                ws.Cells[r + 2, i + 1] = "'" + ds.Tables[d].Rows[r][i].ToString();
            }
        }
        System.Runtime.InteropServices.Marshal.ReleaseComObject(range);
        range = null;
        System.Runtime.InteropServices.Marshal.ReleaseComObject(ws);
        ws = null;

        tProgressBar1.Position = d + 1;//进度条
    }
    ((Worksheet)workbook.Sheets[1]).Select(true);//选中第一个worksheet
    //workbook.Close(true, miss, miss);//关闭workbook, 并保存对workbook的所有修改
    workbook.SaveAs(saveFileDialog.FileName);
    xlapp.DisplayAlerts = true;
    workbook.Close();

    System.Runtime.InteropServices.Marshal.ReleaseComObject(workbook);
    workbook = null;
    xlapp.Quit();
    System.Runtime.InteropServices.Marshal.ReleaseComObject(xlapp);
    xlapp = null;
    GC.Collect();
    GC.WaitForPendingFinalizers();

    tProgressBar1.Dispose();
}
</td></tr></table>
<font  color="DeepSkyBlue" >--//DEV 双击事件</font>
gridView1_MouseDown  和doubleclick
通过行号获得选中行的dataRow
DataRow dataRow = gridView1.GetDataRow(gridView1.FocusedRowHandle);
双击事件，当双击空白gridView1.FocusedRowHandle=0
gridView1_MouseDown参考https://blog.csdn.net/qq_23126581/article/details/70792202


</font></span></pre></figure>

<figure class="highlight bash">
<span><pre><font size="4">	

</span></pre></font></figure>

							<figure class="highlight bash">
								
							</figure>

							
							<figure class="highlight bash">
								
							</figure>
							<figure class="highlight bash">
								
							</figure>
							
							<figure class="highlight bash">
								
								
							</figure>
							<figure class="highlight bash">
								<table>
									<tr>
										<td class="gutter"><pre>
												<span class="line">1</span><br>
											</pre></td>
										<td class="code"><pre>
	                                                     <span class="line">$ hexo deploy</span><br>
											</pre></td>
									</tr>
								</table>
							</figure>

							

						</div>

						<div class="article-info article-info-index">
					<div class="clearfix"></div>
						</div>
					</div>

				</article>
			</div>
			<footer id="footer">
				<div class="outer">
					<div id="footer-info">
						<div class="footer-left">&copy; 2020 XU LIN</div>
						<div class="footer-right">
							<a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a
								href="https://github.com/smackgg/hexo-theme-smackdown"
								target="_blank">Smackdown</a>
						</div>
					</div>
				</div>
			</footer>
		</div>


		<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



		<script>
			var yiliaConfig = {
				fancybox : true,
				mathjax : true,
				animate : true,
				isHome : true,
				isPost : false,
				isArchive : false,
				isTag : false,
				isCategory : false,
				open_in_new : false
			}
		</script>

		<script src="/js/main.js"></script>




		<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

		<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


	</div>
</body>
</html>

